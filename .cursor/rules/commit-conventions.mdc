---
description: Git commit message conventions for this project
---
# Git Commit Conventions

## Commit Message Format

Use clear, descriptive commit messages that explain **what** and **why**.

### Structure

```
<Brief summary line>

- Detailed point 1
- Detailed point 2
- Detailed point 3
```

### Good Examples

```
Complete README overhaul for Cursor migration

- Restructure root README for multi-image project architecture
- Complete rewrite of PlatformIO image README from scratch
- Remove misleading claims about pre-cached toolchains
- Add comprehensive usage examples (CI/CD, local dev)
```

```
Add PlatformIO development image

- Python 3.11 slim base with PlatformIO Core
- Support for ESP32 (all variants) with ESP-IDF
- Unity testing framework pre-installed
- CI/CD optimized for automated builds
```

```
Update Dockerfile to optimize image size

- Remove pre-build step to reduce image from 2GB to 500MB
- Toolchains now download on first build
- Updated README to reflect changes
```

### Bad Examples

âŒ `Update files` - Too vague
âŒ `Fix` - No context
âŒ `WIP` - Not descriptive
âŒ `changes` - Not helpful

## When to Commit

### Do Commit:
- âœ… After completing a logical unit of work
- âœ… After fixing a bug
- âœ… After adding a new feature/image
- âœ… After documentation updates (if substantial)
- âœ… Before switching tasks

### Don't Commit:
- âŒ Broken code (unless it's clearly marked WIP and on feature branch)
- âŒ Half-finished features on main branches
- âŒ Commented-out debugging code
- âŒ Temporary test files

## AI/Cursor Commit Policy

**ğŸš« NEVER AUTO-COMMIT**

- âŒ AI assistants must NEVER commit changes automatically
- âŒ AI assistants must NEVER use `git commit` without explicit user confirmation
- âŒ AI assistants must NEVER stage files automatically for commit (unless explicitly asked)
- âœ… AI CAN suggest commit messages for user review
- âœ… AI CAN propose what should be committed
- âœ… AI can make file changes, edits, and create new files
- âœ… Only the USER decides when to commit (explicit confirmation required)
- âœ… USER must review and approve all commits

**Rationale:** Commits are permanent records. The developer must review all changes and explicitly approve commits, even if the AI suggests the commit message.

## Branch Strategy

- **dev** - Development work, testing
- **master** - Stable releases only
- Feature branches - For experimental work

## Commit Grouping

Group related changes in single commit:
- âœ… Dockerfile + README for same feature
- âœ… All files needed for new image
- âœ… Related documentation updates

Keep separate:
- âŒ Don't mix unrelated changes
- âŒ Don't combine feature + bugfix
- âŒ Don't combine multiple images in one commit

## Files to Always Review

Before committing, double-check:
1. [README.md](mdc:README.md) - Stays generic?
2. [images/*/README.md](mdc:images/) - Accurate?
3. [images/*/Dockerfile](mdc:images/) - Optimized?
4. No debug/temporary files included
5. No sensitive data (secrets, keys)

## Useful Git Commands

```bash
# Check what's staged
git diff --cached

# Commit with detailed message
git commit -m "Summary" -m "Detail 1" -m "Detail 2"

# Amend last commit (if not pushed)
git commit --amend

# Show last commit
git show HEAD --stat
```
